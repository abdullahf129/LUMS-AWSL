This readme is supposed to give an overview of the backend of AWSL web application, the technologies used, the naming conventions, directory structure and the rules for contributions.

Created by: <abdul6wahab6@gmail.com>

# Setup

To setup the backend, clone the GitHub repository, and run the following commands:

```
yarn
yarn dev
```

An env file also needs to be setup with the following fields:
```
NODE_ENV="development" || "production"

PORT
SALT_ROUNDS
DATABASE_URL=mysql://<username>:<password>@localhost:3306/awsl
```

### Note: 

MariaDb does not allow auto-creation of database from the ORM, the database would need to be created beforehand using the MariaDb CLI.

Ensure that mariadb or mysql are installed on your computer, then run the following commands:

```
mariadb -u <username> -p

CREATE DATABASE awsl;
```

# Technologies

The **language** of development is TypeScript.

The **backend** is made with Node/Express JS.

The **database** is MariaDB, used with Prisma ORM.

**Logging** is done through winston.

**Emails** are sent through sendgrid and nodemailer.

**Authentication** is done through PassportJS

Links: 
- [TypeScript](https://typescriptlang.org)
- [ExpressJS](https://expressjs.com/)
- [MariaDB](https://mariadb.org/)
- [PrismaORM](https://www.prisma.io/)
- [SendGrid](https://sendgrid.com/)
- [NodeMailer](https://nodemailer.com/about/)
- [PassportJS](https://www.passportjs.org/)

# Directory Structure

All source code is contained within the `/src` folder. This is done to ensure there is a clean separation of code and config files. 

All TS code is compiled to JS, this is stored in the `dist`  folder. This is the folder used to serve files to the client. NOT the src folder.

The `/logs` folder is used to store all logs generated by winston. This is done to ensure debugging errors is easy when the app is deployed, and to discourage the use of `console.log` in production.

Within the `/src` folder, files are divided across multiple folders.
- The `src/server.ts` file is the root, all routers are aggregated inside the file.
- The `src/routes` folder is used to store all routers. Each major component in the site has its own router, which is then imported into `server.ts`. Each router contains ALL of the routes for that particular component. This may be changed in the future if the number of routes per router grows too much.
- The `src/functions` folder is used to contain functions, such as email sending that are commonly used across different routes and controllers. 
- The `src/prisma` folder contains prisma schema, migrations, and seeders.

# Naming conventions

Each folder name is lowercase.

Each file name is camelCase.

Every function inside a file is camelCase, each file preferably exports only one function, which has the same name as the file. (The adminDashboard.route.ts file exports a router named adminDashboardRouter)

All variables inside a function are snake_case.

# Throwing Errors

Any error occurred in the application should not be logged to the console using console.log

Errors should be thrown using the MyError class present in the `src/interfaces/error.ts` file.

The syntax for that is `throw new MyError(<error text>, <error code>)`

All errors thrown this way are automatically sent to the user, logged to the console, and added to the log file.